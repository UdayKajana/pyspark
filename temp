function uniqueAndMultiMatch() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var sourceSheet = spreadsheet.getActiveSheet();
  var timestamp = new Date().toISOString().replace(/[:.]/g, '_');
  var newSheet = spreadsheet.insertSheet('Split_Data_' + timestamp);
  
  // Get data from both columns
  var lastRow = sourceSheet.getLastRow();
  var rangeA = sourceSheet.getRange("A1:A" + lastRow).getValues();
  var rangeB = sourceSheet.getRange("B1:B" + lastRow).getValues();
  
  // Create a map to store unique keys and their corresponding values
  var dataMap = new Map();
  
  // Process each row starting from index 1 to skip header
  for (var row = 1; row < rangeA.length; row++) {
    var key = rangeA[row][0];
    var value = rangeB[row][0];
    
    // Skip if either key or value is empty
    if (!key || !value) continue;
    
    // If key exists, append the new value; otherwise create new array
    if (dataMap.has(key)) {
      var existingValues = dataMap.get(key);
      if (!existingValues.includes(value)) { // Avoid duplicate values
        existingValues.push(value);
      }
    } else {
      dataMap.set(key, [value]);
    }
  }
  
  // Convert map to array for sheet output
  var newData = [];
  newData.push(['Key', 'Values']); // Add headers
  
  dataMap.forEach((values, key) => {
    newData.push([key, values.join('\n')]);
  });
  
  // Write to new sheet
  if (newData.length > 1) { // Only write if we have data beyond headers
    newSheet.getRange(1, 1, newData.length, 2).setValues(newData);
    newSheet.autoResizeColumns(1, 2);
    
    // Apply banding to all rows except header
    if (newData.length > 2) {
      newSheet.getRange(2, 1, newData.length - 1, 2).applyRowBanding();
    }
  }
  
  // Activate the new sheet and show completion message
  newSheet.activate();
  SpreadsheetApp.getUi().alert(
    'Process Complete',
    'Created ' + (newData.length - 1) + ' unique keys with consolidated values in "' + newSheet.getName() + '"',
    SpreadsheetApp.getUi().ButtonSet.OK
  );
}

// Update the onOpen function to include the new function
function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('Custom Scripts')
    .addItem('Multi Line to Multi Row', 'multiLineToMultiRow')
    .addItem('Remove Duplicate Rows', 'removeDuplicateRows')
    .addItem('Unique and Multi Match', 'uniqueAndMultiMatch')
    .addToUi();
}
