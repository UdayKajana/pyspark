class DecodeAvroRecords(beam.DoFn):
    def process(self, element, timestamp=beam.DoFn.TimestampParam) -> Iterator[dict]:
        try:
            logging.info(f"Processing element: {element[:100]}...")  # Log truncated element
            avro_data = element['data'] if isinstance(element, dict) and 'data' in element else element
            logging.info(f"Extracted avro_data type: {type(avro_data)}")
            
            # Rest of your processing logic...
            
        except Exception as e:
            logging.error(f"Error processing message: {str(e)}")
            logging.error(f"Element type: {type(element)}")
            logging.error(f"Element content: {element}")
            raise  # Re-raise to see errors in Dataflow logs
