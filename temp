function splitMultilineToRows() {
  // Get the active spreadsheet and sheet
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = spreadsheet.getActiveSheet();
  
  // Get values from A1 and B1
  var tablesList = sheet.getRange("A1").getValue();
  var dataset = sheet.getRange("B1").getValue();
  
  // Split the multiline text into array
  var tables = tablesList.split("\n");
  
  // Clear existing content (optional)
  // Uncomment the next line if you want to clear existing data
  // sheet.getRange("A1:B" + (sheet.getLastRow())).clearContent();
  
  // Create data array for batch update
  var newData = [];
  for (var i = 0; i < tables.length; i++) {
    // Trim each table name to remove extra spaces
    var tableName = tables[i].trim();
    if (tableName) {  // Only add non-empty lines
      newData.push([tableName, dataset]);
    }
  }
  
  // Write all data at once
  if (newData.length > 0) {
    sheet.getRange(1, 1, newData.length, 2).setValues(newData);
  }
  
  // Optional: Auto-resize columns to fit new content
  sheet.autoResizeColumns(1, 2);
}

// Add a custom menu to run the script
function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('Custom Scripts')
    .addItem('Split Multiline to Rows', 'splitMultilineToRows')
    .addToUi();
}
